var I=s=>{throw TypeError(s)};var J=(s,e,t)=>e.has(s)||I("Cannot "+t);var a=(s,e,t)=>(J(s,e,"read from private field"),t?t.call(s):e.get(s)),h=(s,e,t)=>e.has(s)?I("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),d=(s,e,t,r)=>(J(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t),p=(s,e,t)=>(J(s,e,"access private method"),t);var k=(s,e,t,r)=>({set _(i){d(s,e,i,t)},get _(){return a(s,e,r)}});import{a as D,t as q}from"../chunks/disclose-version.DygF9grk.js";import"../chunks/legacy.DhKI_Mqn.js";import{a5 as B,v as R,a6 as C,d as c,c as b,p as G,l as z,j as H,t as T,k as Q,a7 as M,a8 as A,a9 as U,m as w,r as _}from"../chunks/runtime.bnBzEFEb.js";import{h as X,s as Y}from"../chunks/render.riEEkV59.js";import{r as Z}from"../chunks/attributes.COMWg3C9.js";import{d as ee}from"../chunks/events.DzUZvcg_.js";import{b as te}from"../chunks/input.CqDCL8Uf.js";import{i as re}from"../chunks/lifecycle.CkGY6yrm.js";import{o as ae}from"../chunks/index-client.CCMSCnBi.js";const se=!0,ie=!0,le=!1,oe="always",we=Object.freeze(Object.defineProperty({__proto__:null,csr:ie,prerender:se,ssr:le,trailingSlash:oe},Symbol.toStringTag,{value:"Module"}));var f,n,v,o,S,$,y,u,E,O,m;const x=class x{constructor(e,t,r){h(this,u);h(this,f);h(this,n);h(this,v,0);h(this,o,B(0));h(this,S,new WeakMap);h(this,$,JSON.stringify);h(this,y,JSON.parse);h(this,m,e=>{if(e.key===a(this,f)&&e.newValue!==null)try{const t=a(this,y).call(this,e.newValue);JSON.stringify(a(this,n))!==JSON.stringify(t)&&R(()=>{d(this,n,t),b(a(this,o),c(a(this,o))+1)})}catch(t){console.error(`Failed to handle storage event for '${a(this,f)}':`,t)}});d(this,f,e),a(this,o).v=0,r!=null&&r.serialize&&d(this,$,r.serialize),r!=null&&r.deserialize&&d(this,y,r.deserialize);try{R(()=>{const i=localStorage.getItem(a(this,f));i!==null?d(this,n,a(this,y).call(this,i)):(d(this,n,t),p(this,u,O).call(this,t)),window.addEventListener("storage",a(this,m))})}catch(i){console.error(`Failed to initialize store '${a(this,f)}':`,i),d(this,n,t)}C(()=>(a(this,v)===0&&window.addEventListener("storage",a(this,m)),k(this,v)._++,()=>{k(this,v)._--,a(this,v)===0&&window.removeEventListener("storage",a(this,m))}))}get value(){return c(a(this,o)),p(this,u,E).call(this,a(this,n))}set value(e){d(this,n,e),p(this,u,O).call(this,e),b(a(this,o),c(a(this,o))+1)}destroy(){window.removeEventListener("storage",a(this,m))}static fromLocalStorage(e,t){try{const r=localStorage.getItem(e);if(r!==null){const i=t!=null&&t.deserialize?t.deserialize(r):JSON.parse(r);return new x(e,i,t)}else return console.warn(`Key '${e}' not found in localStorage.`),null}catch(r){return console.error(`Failed to create store from localStorage for '${e}':`,r),null}}static getAll(e,t){const r={};for(let i=0;i<localStorage.length;i++){const l=localStorage.key(i);if(l&&l.startsWith(e))try{const g=localStorage.getItem(l),N=t!=null&&t.deserialize?t.deserialize(g||"{}"):JSON.parse(g||"{}");r[l]=new x(l,N,t)}catch(g){console.error(`Failed to parse store from localStorage for '${l}':`,g)}}return r}static createWithPrefix(e,t,r,i){const l=`${e}:${t}`;return new x(l,r,i)}};f=new WeakMap,n=new WeakMap,v=new WeakMap,o=new WeakMap,S=new WeakMap,$=new WeakMap,y=new WeakMap,u=new WeakSet,E=function(e){if(typeof e!="object"||e===null)return e;if(!a(this,S).has(e)){const t=new Proxy(e,{get:(r,i)=>(c(a(this,o)),p(this,u,E).call(this,Reflect.get(r,i))),set:(r,i,l)=>(b(a(this,o),c(a(this,o))+1),Reflect.set(r,i,l),p(this,u,O).call(this,a(this,n)),!0)});a(this,S).set(e,t)}return a(this,S).get(e)},O=function(e){try{localStorage.setItem(a(this,f),a(this,$).call(this,e))}catch(t){console.error(`Failed to persist store '${a(this,f)}':`,t)}},m=new WeakMap;let P=x;function ce(s,e){M(e,c(e).value=[...c(e).value||[],{id:Date.now(),text:`Note ${c(e).value.length+1}`}])}var ne=q('<h2>Reaper Store</h2> <p>This is a Library for Svelte 5 to create persistant and reactive stores.</p> <div class="row"><div class="addNote col-5 svelte-1og331p"><button id="addNote">Add Note</button> <pre class="svelte-1og331p"> </pre></div> <div class="changeTitle col-5 svelte-1og331p"><label>Edit page title <input type="text"></label></div></div>',1);function _e(s,e){G(e,!1);let t=A(),r=A();ae(()=>{b(t,P.createWithPrefix("myApp","notesStore",[{id:1,text:"Note 1"}])),b(r,P.createWithPrefix("ReaPer:","Title","Svelte-ReaPer-Store"))}),re();var i=ne();X(j=>{T(()=>U.title=c(r).value)});var l=z(H(i),4),g=w(l),N=w(g);N.__click=[ce,t];var L=z(N,2),K=w(L);T(()=>Y(K,`
      ${JSON.stringify(c(t).value,null,2)??""}
    `)),_(L),_(g);var F=z(g,2),V=w(F),W=z(w(V));Z(W),_(V),_(F),_(l),te(W,()=>c(r).value,j=>M(r,c(r).value=j)),D(s,i),Q()}ee(["click"]);export{_e as component,we as universal};
