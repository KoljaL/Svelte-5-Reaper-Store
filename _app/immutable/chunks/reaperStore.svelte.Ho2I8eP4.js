var L=i=>{throw TypeError(i)};var N=(i,e,t)=>e.has(i)||L("Cannot "+t);var r=(i,e,t)=>(N(i,e,"read from private field"),t?t.call(i):e.get(i)),c=(i,e,t)=>e.has(i)?L("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),n=(i,e,t,s)=>(N(i,e,"write to private field"),s?s.call(i,t):e.set(i,t),t),S=(i,e,t)=>(N(i,e,"access private method"),t);var O=(i,e,t,s)=>({set _(a){n(i,e,a,t)},get _(){return r(i,e,s)}});import{n as k,u as V,q as P,d as m,c as E}from"./runtime.BpnjGcjJ.js";var f,h,g,l,w,$,y,d,F,J,u;const z=class z{constructor(e,t,s){c(this,d);c(this,f);c(this,h);c(this,g,0);c(this,l,k(0));c(this,w,new WeakMap);c(this,$,JSON.stringify);c(this,y,JSON.parse);c(this,u,e=>{if(e.key===r(this,f)&&e.newValue!==null)try{const t=r(this,y).call(this,e.newValue);JSON.stringify(r(this,h))!==JSON.stringify(t)&&V(()=>{n(this,h,t),E(r(this,l),m(r(this,l))+1)})}catch(t){console.error(`Failed to handle storage event for '${r(this,f)}':`,t)}});n(this,f,e),r(this,l).v=0,s!=null&&s.serialize&&n(this,$,s.serialize),s!=null&&s.deserialize&&n(this,y,s.deserialize);try{V(()=>{const a=localStorage.getItem(r(this,f));a!==null?n(this,h,r(this,y).call(this,a)):(n(this,h,t),S(this,d,J).call(this,t)),window.addEventListener("storage",r(this,u))})}catch(a){console.error(`Failed to initialize store '${r(this,f)}':`,a),n(this,h,t)}P(()=>(r(this,g)===0&&window.addEventListener("storage",r(this,u)),O(this,g)._++,()=>{O(this,g)._--,r(this,g)===0&&window.removeEventListener("storage",r(this,u))}))}get value(){return m(r(this,l)),S(this,d,F).call(this,r(this,h))}set value(e){n(this,h,e),S(this,d,J).call(this,e),E(r(this,l),m(r(this,l))+1)}destroy(){window.removeEventListener("storage",r(this,u))}static fromLocalStorage(e,t){try{const s=localStorage.getItem(e);if(s!==null){const a=t!=null&&t.deserialize?t.deserialize(s):JSON.parse(s);return new z(e,a,t)}else return console.warn(`Key '${e}' not found in localStorage.`),null}catch(s){return console.error(`Failed to create store from localStorage for '${e}':`,s),null}}static getAll(e,t){const s={};for(let a=0;a<localStorage.length;a++){const o=localStorage.key(a);if(o&&o.startsWith(e))try{const x=localStorage.getItem(o),I=t!=null&&t.deserialize?t.deserialize(x||"{}"):JSON.parse(x||"{}");s[o]=new z(o,I,t)}catch(x){console.error(`Failed to parse store from localStorage for '${o}':`,x)}}return s}static createWithPrefix(e,t,s,a){const o=`${e}:${t}`;return new z(o,s,a)}};f=new WeakMap,h=new WeakMap,g=new WeakMap,l=new WeakMap,w=new WeakMap,$=new WeakMap,y=new WeakMap,d=new WeakSet,F=function(e){if(typeof e!="object"||e===null)return e;if(!r(this,w).has(e)){const t=new Proxy(e,{get:(s,a)=>(m(r(this,l)),S(this,d,F).call(this,Reflect.get(s,a))),set:(s,a,o)=>(E(r(this,l),m(r(this,l))+1),Reflect.set(s,a,o),S(this,d,J).call(this,r(this,h)),!0)});r(this,w).set(e,t)}return r(this,w).get(e)},J=function(e){try{localStorage.setItem(r(this,f),r(this,$).call(this,e))}catch(t){console.error(`Failed to persist store '${r(this,f)}':`,t)}},u=new WeakMap;let v=z;export{v as R};
